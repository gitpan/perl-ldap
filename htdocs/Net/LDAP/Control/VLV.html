<HTML>
<HEAD>
<TITLE>Net::LDAP::Control::VLV - LDAPv3 Virtual List View control object</TITLE>
<LINK REV="made" HREF="mailto:hackers@FreeBSD.org">
</HEAD>

<BODY>

<!-- INDEX BEGIN -->
<!--

<UL>

	<LI><A HREF="#NAME">NAME</A>
	<LI><A HREF="#SYNOPSIS">SYNOPSIS</A>
	<LI><A HREF="#DESCRIPTION">DESCRIPTION</A>
	<LI><A HREF="#CONSTRUCTOR_ARGUMENTS">CONSTRUCTOR ARGUMENTS</A>
	<UL>

		<LI><A HREF="#METHODS">METHODS</A>
	</UL>

	<LI><A HREF="#SEE_ALSO">SEE ALSO</A>
	<LI><A HREF="#AUTHOR">AUTHOR</A>
	<LI><A HREF="#COPYRIGHT">COPYRIGHT</A>
</UL>
-->
<!-- INDEX END -->

<P>
<H1><A NAME="NAME">NAME</A></H1>
<P>
Net::LDAP::Control::VLV - LDAPv3 Virtual List View control object

<P>
<HR>
<H1><A NAME="SYNOPSIS">SYNOPSIS</A></H1>
<P>
<PRE> use Net::LDAP;
 use Net::LDAP::Control::VLV;
 use Net::LDAP::Constant qw( LDAP_CONTROL_VLVRESPONSE );
</PRE>
<P>
<PRE> $ldap = Net::LDAP-&gt;new( &quot;ldap.mydomain.eg&quot; );
</PRE>
<P>
<PRE> # Get the first 20 entries
 $vlv  = Net::LDAP::Control::VLV-&gt;new(
           before  =&gt; 0,        # No entries from before target entry
           after   =&gt; 19,       # 19 entries after target entry
           content =&gt; 0,        # List size unknown
           offset  =&gt; 1,        # Target entry is the first
         );
 $sort = Net::LDAP::Control::Sort-&gt;new( sort =&gt; 'cn' );
</PRE>
<P>
<PRE> @args = ( base     =&gt; &quot;o=Ace Industry, c=us&quot;,
           scope    =&gt; &quot;subtree&quot;,
           filter   =&gt; &quot;(objectClass=inetOrgPerson)&quot;,
           callback =&gt; \&amp;process_entry, # Call this sub for each entry
           control  =&gt; [ $vlv, $sort ],
 );
</PRE>
<P>
<PRE> $mesg = $ldap-&gt;search( @args );
</PRE>
<P>
<PRE> # Get VLV response control
 ($resp)  = $mesg-&gt;control( LDAP_CONTROL_VLVRESPONSE ) or die;
 $vlv-&gt;response( $resp );
</PRE>
<P>
<PRE> # Set the control to get the last 20 entries
 $vlv-&gt;end;
</PRE>
<P>
<PRE> $mesg = $ldap-&gt;search( @args );
</PRE>
<P>
<PRE> # Get VLV response control
 ($resp)  = $mesg-&gt;control( LDAP_CONTROL_VLVRESPONSE ) or die;
 $vlv-&gt;response( $resp );
</PRE>
<P>
<PRE> # Now get the previous page
 $vlv-&gt;scroll_page( -1 );
</PRE>
<P>
<PRE> $mesg = $ldap-&gt;search( @args );
</PRE>
<P>
<PRE> # Get VLV response control
 ($resp)  = $mesg-&gt;control( LDAP_CONTROL_VLVRESPONSE ) or die;
 $vlv-&gt;response( $resp );
</PRE>
<P>
<PRE> # Now page with first entry starting with &quot;B&quot; in the middle
 $vlv-&gt;before(9);       # Change page to show 9 before
 $vlv-&gt;after(10);       # Change page to show 10 after
 $vlv-&gt;assert(&quot;B&quot;);     # assert &quot;B&quot;
 
 $mesg = $ldap-&gt;search( @args );
</PRE>
<P>
<HR>
<H1><A NAME="DESCRIPTION">DESCRIPTION</A></H1>
<P>
<CODE>Net::LDAP::Control::VLV</CODE> provides an interface for the creation and manipulation of objects that
represent the Virtual List View as described by
draft-ietf-ldapext-ldapv3-vlv-03.txt.

<P>
When using a Virtual List View control in a search, it must be accompanied
by a sort control. See <A HREF="../../../Net/LDAP/Control/Sort|Net/LDAP/Control/Sort.html">Net::LDAP::Control::Sort|Net::LDAP::Control::Sort</A>



<P>
<HR>
<H1><A NAME="CONSTRUCTOR_ARGUMENTS">CONSTRUCTOR ARGUMENTS</A></H1>
<P>
In addition to the constructor arguments described in
<A HREF="../../../Net/LDAP/Control|Net/LDAP/Control.html">Net::LDAP::Control|Net::LDAP::Control</A> the following are provided.

<DL>
<DT><STRONG><A NAME="item_after">after</A></STRONG><DD>
<P>
Set the number of entries the server should return from the list after the
target entry.

<DT><STRONG><A NAME="item_assert">assert</A></STRONG><DD>
<P>
Set the assertion value user to locate the target entry. This value should
be a legal value to compare with the first attribute in the sort control
that is passed with the VLV control. The target entry is the first entry in
the list which is greater than or equal the assert value.

<DT><STRONG><A NAME="item_before">before</A></STRONG><DD>
<P>
Set the number of entries the server should return from the list before the
target entry.

<DT><STRONG><A NAME="item_content">content</A></STRONG><DD>
<P>
Set the number of entries in the list. On the first search this value
should be set to zero. On subsequent searches it should be set to the
length of the list, as returned by the server in the VLVResponse control.

<DT><STRONG><A NAME="item_context">context</A></STRONG><DD>
<P>
Set the context identifier. On the first search this value should be set to
zero. On subsequent searches it should be set to the context value returned
by the server in the VLVResponse control.

<DT><STRONG><A NAME="item_offset">offset</A></STRONG><DD>
<P>
Set the offset of the target entry.

</DL>
<P>
<HR>
<H2><A NAME="METHODS">METHODS</A></H2>
<P>
As with <A HREF="../../../Net/LDAP/Control|Net/LDAP/Control.html">Net::LDAP::Control|Net::LDAP::Control</A> each constructor argument described above is also avaliable as a method on
the object which will return the current value for the attribute if called
without an argument, and set a new value for the attribute if called with
an argument.

<P>
The <A HREF="#item_offset">offset</A> and <A HREF="#item_assert">assert</A> attributes are mutually exclusive. Setting one or the other will cause
previous values set by the other to be forgotten. The <A HREF="#item_content">content</A> attribute is also associated with the
<A HREF="#item_offset">offset</A> attribute, so setting <A HREF="#item_assert">assert</A> will cause any <A HREF="#item_content">content</A>
value to be forgotten.

<DL>
<DT><STRONG><A NAME="item_end">end</A></STRONG><DD>
<P>
Set the target entry to the end of the list. This method will change the <A HREF="#item_before">before</A>
and <A HREF="#item_after">after</A> attributes so that the target entry is the last in the page.

<DT><STRONG><A NAME="item_response">response VLV_RESPONSE</A></STRONG><DD>
<P>
Set the attributes in the control as per VLV_RESPONSE. VLV_RESPONSE should
be a control of type <A HREF="../../../Net/LDAP/Control/VLVResponse|Net/LDAP/Control/VLVResponse.html">Net::LDAP::Control::VLVResponse|Net::LDAP::Control::VLVResponse</A> returned from the server. <A HREF="#item_response">response</A> will populate the <A HREF="#item_context">context</A>, <A HREF="#item_offset">offset</A> and <A HREF="#item_content">content</A>
attibutes of the control with the values from VLV_RESPONSE. Because this
sets the
<A HREF="#item_offset">offset</A> attribute, any previous setting of the <A HREF="#item_assert">assert</A> attribute will be forgotten.

<DT><STRONG><A NAME="item_scroll">scroll NUM</A></STRONG><DD>
<P>
Move the target entry by NUM entries. A positive NUM will move the target
entry towards the end of the list and a negative NUM will move the target
entry towards the start of the list. Returns the index of the new target
entry, or <CODE>undef</CODE> if the current target is identified by an assertion.

<P>
<A HREF="#item_scroll">scroll</A> may change the <A HREF="#item_before">before</A> and <A HREF="#item_after">after</A> attributes if the scroll value would cause the page to go off either end of
the list. But the page size will be maintained.

<DT><STRONG><A NAME="item_scroll_page">scroll_page NUM</A></STRONG><DD>
<P>
Scroll by NUM pages. This method simple calculates the current page size
and calls
<A HREF="#item_scroll">scroll</A> with <CODE>NUM * $page_size</CODE>



<DT><STRONG><A NAME="item_start">start</A></STRONG><DD>
<P>
Set the target entry to the start of the list. This method will change the <A HREF="#item_before">before</A> and <A HREF="#item_after">after</A>
attributes to the the target entry is the first entry in the page.

</DL>
<P>
<HR>
<H1><A NAME="SEE_ALSO">SEE ALSO</A></H1>
<P>
<A HREF="../../../Net/LDAP|Net/LDAP.html">Net::LDAP|Net::LDAP</A>,
<A HREF="../../../Net/LDAP/Control|Net/LDAP/Control.html">Net::LDAP::Control|Net::LDAP::Control</A>,
<A HREF="../../../Net/LDAP/Control/Sort|Net/LDAP/Control/Sort.html">Net::LDAP::Control::Sort|Net::LDAP::Control::Sort</A>,
<A HREF="../../../Net/LDAP/Control/VLVResponse|Net/LDAP/Control/VLVResponse.html">Net::LDAP::Control::VLVResponse|Net::LDAP::Control::VLVResponse</A>



<P>
<HR>
<H1><A NAME="AUTHOR">AUTHOR</A></H1>
<P>
Graham Barr &lt;<A HREF="mailto:gbarr@pobox.com">gbarr@pobox.com</A>&gt;

<P>
Please report any bugs, or post any suggestions, to the perl-ldap mailing
list &lt;<A
HREF="mailto:perl-ldap-dev@lists.sourceforge.net">perl-ldap-dev@lists.sourceforge.net</A>&gt;


<P>
<HR>
<H1><A NAME="COPYRIGHT">COPYRIGHT</A></H1>
<P>
Copyright (c) 2000 Graham Barr. All rights reserved. This program is free
software; you can redistribute it and/or modify it under the same terms as
Perl itself.

<hr>

<P>
<EM>$Id: VLV.pm,v 1.3 2000/07/30 21:03:50 gbarr Exp $</EM>



</BODY>

</HTML>
