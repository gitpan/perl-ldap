<HTML>
<HEAD>
<TITLE>Net::LDAP::FAQ - Frequently Asked Questions about Net::LDAP</TITLE>
<LINK REV="made" HREF="mailto:hackers@FreeBSD.org">
</HEAD>

<BODY>

<!-- INDEX BEGIN -->

<UL>

	<LI><A HREF="#NAME">NAME</A>
	<LI><A HREF="#SYNOPSIS">SYNOPSIS</A>
	<LI><A HREF="#DESCRIPTION">DESCRIPTION</A>
	<LI><A HREF="#GENERAL">GENERAL</A>
	<UL>

		<LI><A HREF="#What_is_perl_ldap_">What is perl-ldap ?</A>
		<LI><A HREF="#Why_another_perl_LDAP_implementa">Why another perl LDAP implementation ?</A>
		<LI><A HREF="#Where_can_I_get_it_">Where can I get it ?</A>
		<LI><A HREF="#Is_there_a_web_page_for_perl_lda">Is there a web page for perl-ldap ?</A>
		<LI><A HREF="#Is_there_a_mailing_list_">Is there a mailing list ?</A>
		<LI><A HREF="#Is_the_mailing_list_archived_">Is the mailing list archived ?</A>
		<LI><A HREF="#Is_there_any_online_documentatio">Is there any online documentation ?</A>
		<LI><A HREF="#Is_there_a_public_CVS_repository">Is there a public CVS repository ?</A>
		<LI><A HREF="#Can_I_get_perl_ldap_from_the_pub">Can I get perl-ldap from the public CVS repository?</A>
		<LI><A HREF="#What_is_CVS_">What is CVS.</A>
	</UL>

	<LI><A HREF="#LDAP_AND_DIRECTORY_TERMINOLOGY_">LDAP AND DIRECTORY TERMINOLOGY.</A>
	<UL>

		<LI><A HREF="#What_is_a_directory_">What is a directory.</A>
		<LI><A HREF="#What_is_LDAP_">What is LDAP.</A>
		<LI><A HREF="#What_is_a_LDAP_Directory_">What is a LDAP Directory.</A>
		<LI><A HREF="#What_is_an_Entry_">What is an Entry.</A>
		<LI><A HREF="#What_is_a_Distinguished_Name_">What is a Distinguished Name.</A>
		<LI><A HREF="#What_is_a_Relative_Distinguished">What is a Relative Distinguished Name.</A>
		<LI><A HREF="#What_is_a_Naming_RDN_">What is a Naming RDN.</A>
		<LI><A HREF="#What_is_a_search_base_">What is a search base.</A>
		<LI><A HREF="#What_is_an_attribute_">What is an attribute.</A>
		<LI><A HREF="#What_is_the_difference_between_a">What is the difference between a LDAP server and a relational database</A>
		<LI><A HREF="#What_is_the_difference_between_a">What is the difference between a ldap reference and a ldap referral?</A>
	</UL>

	<LI><A HREF="#PERL_LDAP_INSTALLATION">PERL-LDAP INSTALLATION</A>
	<UL>

		<LI><A HREF="#How_do_I_install_perl_ldap_">How do I install perl-ldap ?</A>
		<LI><A HREF="#But_I_do_not_have_make_how_can_">But I do not have make, how can I install perl-ldap ?</A>
		<LI><A HREF="#What_other_modules_will_I_need_">What other modules will I need ?</A>
	</UL>

	<LI><A HREF="#USING_NET_LDAP">USING NET::LDAP</A>
	<UL>

		<LI><A HREF="#How_do_I_connect_to_my_server_">How do I connect to my server ?</A>
		<LI><A HREF="#Net_LDAP_new_sometimes_returns">Net::LDAP-&gt;new sometimes returns undef, why ?</A>
		<LI><A HREF="#How_can_I_tell_when_the_server_r">How can I tell when the server returns an error, bind() always returns</A>
		<LI><A HREF="#How_can_I_set_the_ldap_version_o">How can I set the ldap version of a connection to my ldap server?</A>
		<LI><A HREF="#I_did_a_search_on_my_directory_u">I did a search on my directory using the 'search' method. Where did</A>
		<LI><A HREF="#How_do_I_limit_the_scope_of_a_di">How do I limit the scope of a directory search.</A>
	</UL>

	<LI><A HREF="#GETTING_SEARCH_RESULTS">GETTING SEARCH RESULTS</A>
	<UL>

		<LI><A HREF="#USING_THE_INLINE_APPROACH">USING THE INLINE APPROACH</A>
		<LI><A HREF="#USING_THE_CALLBACK_SUBROUTINE_AP">USING THE CALLBACK SUBROUTINE APPROACH</A>
	</UL>

	<LI><A HREF="#USING_NET_LDAPS">USING NET::LDAPS</A>
	<UL>

		<LI><A HREF="#Using_a_potentially_encrypted_S">Using a potentially encrypted (SSL) network connection, how do I connect to my server?</A>
	</UL>

	<LI><A HREF="#USING_LDAP_GROUPS_">USING LDAP GROUPS.</A>
	<UL>

		<LI><A HREF="#What_are_LDAP_groups_">What are LDAP groups.</A>
		<LI><A HREF="#How_do_you_format_a_filter_to_se">How do you format a filter to search for entries whose 'member'</A>
	</UL>

	<LI><A HREF="#USING_DSML_">USING DSML.</A>
	<UL>

		<LI><A HREF="#How_can_I_access_DSML_features_f">How can I access DSML features from PERL-LDAP.</A>
	</UL>

	<LI><A HREF="#USING_CONTROLS_AND_VIRTUAL_LISTS">USING CONTROLS AND VIRTUAL LISTS.</A>
	<UL>

		<LI><A HREF="#How_do_I_access_the_Control_feat">How do I access the Control features.</A>
		<LI><A HREF="#How_do_I_access_the_Virtual_List">How do I access the Virtual List features.</A>
	</UL>

	<LI><A HREF="#GENERAL_QUESTIONS_">GENERAL QUESTIONS.</A>
	<UL>

		<LI><A HREF="#Are_there_any_other_code_example">Are there any other code examples.</A>
		<LI><A HREF="#Can_I_contribute_perl_scripts_th">Can I contribute perl scripts that use perl-ldap</A>
		<LI><A HREF="#Is_possible_to_get_a_complete_en">Is possible to get a complete entry, dn and attributes </A>
		<LI><A HREF="#How_do_I_put_a_jpeg_photo_into_a">How do I put a jpeg photo into a entry in the directory.</A>
		<LI><A HREF="#How_do_I_add_a_jpeg_photo_into_a">How do I add a jpeg photo into a entry in the directory via html-forms.</A>
		<LI><A HREF="#What_happens_when_you_delete_an_">What happens when you delete an attribute that does not exist.</A>
		<LI><A HREF="#How_can_I_delete_a_referral_from">How can I delete a referral from an LDAP tree.</A>
		<LI><A HREF="#How_do_I_add_an_ACI_ACL_entry_to">How do I add an ACI/ACL entry to a directory server with</A>
		<LI><A HREF="#How_do_I_avoid_file_type_and_dat">How do I avoid file type and data type miss-matching when loading</A>
		<LI><A HREF="#How_do_I_create_a_Microsoft_Exch">How do I create a Microsoft Exchange user.</A>
	</UL>

	<LI><A HREF="#Using_X_509_certificates_">Using X.509 certificates.</A>
	<UL>

		<LI><A HREF="#How_do_I_store_X_509_certificate">How do I store X.509 certificates in the directory?</A>
	</UL>

	<LI><A HREF="#ADDITIONAL_DIRECTORY_AND_LDAP_RE">ADDITIONAL DIRECTORY AND LDAP RESOURCES.</A>
	<UL>

		<LI><A HREF="#URL_s_">URL(s).</A>
		<LI><A HREF="#BOOK_s_">BOOK(s)</A>
	</UL>

	<LI><A HREF="#AUTHOR_s_">AUTHOR(s)</A>
	<LI><A HREF="#COPYRIGHT">COPYRIGHT</A>
</UL>
<!-- INDEX END -->

<HR>
<P>
<H1><A NAME="NAME">NAME</A></H1>
<P>
Net::LDAP::FAQ - Frequently Asked Questions about Net::LDAP

<P>
<HR>
<H1><A NAME="SYNOPSIS">SYNOPSIS</A></H1>
<P>
<PRE> perldoc Net::LDAP::FAQ
</PRE>
<P>
<HR>
<H1><A NAME="DESCRIPTION">DESCRIPTION</A></H1>
<P>
This document serves to answer the most frequently asked questions on both
the perl-ldap Mailing List and those sent to Graham Barr.

<P>
The latest version of this FAQ can be found at <A
HREF="http://perl-ldap.sourceforge.net/FAQ.html">http://perl-ldap.sourceforge.net/FAQ.html</A>


<P>
<HR>
<H1><A NAME="GENERAL">GENERAL</A></H1>
<P>
<HR>
<H2><A NAME="What_is_perl_ldap_">What is perl-ldap ?</A></H2>
<P>
perl-ldap is the distribution name. The perl-ldap distribution contains the
Net::LDAP modules.

<P>
<HR>
<H2><A NAME="Why_another_perl_LDAP_implementa">Why another perl LDAP implementation ?</A></H2>
<P>
perl-ldap's goal is to be as portable as possible. It does this by being
implemented completely in perl. So basically anywhere that perl runs
perl-ldap will run. This is not true for other implementations which
require a C compiler.

<P>
<HR>
<H2><A NAME="Where_can_I_get_it_">Where can I get it ?</A></H2>
<P>
Perl-ldap is available from CPAN. You will find it in the authors/id/GBARR
directory. Alternatively you can download the latest version from <A
HREF="http://www.cpan.org/search?dist=perl-ldap">http://www.cpan.org/search?dist=perl-ldap</A>


<P>
<STRONG>WARNING:</STRONG>  The perl-ldap module is stored on CPAN as a *.gz file. Netscape on Windows
systems sometimes has a problem storing the module with the correct name,
it will replace the *.tar.gz with *_tar.tar. To correct the problem, with
the pointer on the link, do a right click and then select <STRONG>save link as</STRONG> to save the file with the correct file name.

<P>
<HR>
<H2><A NAME="Is_there_a_web_page_for_perl_lda">Is there a web page for perl-ldap ?</A></H2>
<P>
Yes there is at <A
HREF="http://perl-ldap.sourceforge.net/">http://perl-ldap.sourceforge.net/</A>


<P>
<HR>
<H2><A NAME="Is_there_a_mailing_list_">Is there a mailing list ?</A></H2>
<P>
Yes there is at <A
HREF="mailto:perl-ldap-dev@lists.sourceforge.net">perl-ldap-dev@lists.sourceforge.net</A>


<P>
You can subscribe to this list at <A
HREF="http://lists.sourceforge.net/mailman/listinfo/perl-ldap-dev">http://lists.sourceforge.net/mailman/listinfo/perl-ldap-dev</A>


<P>
<HR>
<H2><A NAME="Is_the_mailing_list_archived_">Is the mailing list archived ?</A></H2>
<P>
Archives of messages since we switched to using sourceforge can be found at

<P>
<PRE> <A HREF="http://www.geocrawler.com/lists/3/SourceForge/3482/0/">http://www.geocrawler.com/lists/3/SourceForge/3482/0/</A>
</PRE>
<P>
Please be aware that the geocrawler system munges code that is in the email
messages. In particular, apostrophes (') are turned into back ticks (`) and
newlines escapes (\n) are removed (and probably other escapes as well).  

<P>
There is also an archive of the perl-ldap mailing list at <A
HREF="http://www.xray.mpe.mpg.de/mailing-lists/perl-ldap/">http://www.xray.mpe.mpg.de/mailing-lists/perl-ldap/</A>
which also has messages from before the move to sourceforge. The xray
archive does not munge email messages.

<P>
<HR>
<H2><A NAME="Is_there_any_online_documentatio">Is there any online documentation ?</A></H2>
<P>
Yes. perl-ldap has online documentation at <A
HREF="http://perl-ldap.sourceforge.net/">http://perl-ldap.sourceforge.net/</A>
which will have the latest documentation available.

<P>
<HR>
<H2><A NAME="Is_there_a_public_CVS_repository">Is there a public CVS repository ?</A></H2>
<P>
Yes, it is located at sourceforge.net

<P>
<HR>
<H2><A NAME="Can_I_get_perl_ldap_from_the_pub">Can I get perl-ldap from the public CVS repository?</A></H2>
<P>
Yes, any one can pull perl-ldap from the public CVS repository on
sourceforge.net.

<P>
There are several ways this can be done.

<P>
Web;

<P>
You can download it from SourceForge by following the release link:  

<P>
The 2 lines in the following example should be put together as one
continuous line. Example;

<P>
<PRE> <A HREF="http://download.sourceforge.net/perl-ldap/perl-ldap-0.20.tar.gz">http://download.sourceforge.net/perl-ldap/perl-ldap-0.20.tar.gz</A>
</PRE>
<P>
<STRONG>WARNING:</STRONG>  The perl-ldap module is stored on CPAN as a *.gz file. Netscape on Windows
systems sometimes has a problem storing the module with the correct name,
it will replace the *.tar.gz with *_tar.tar. To correct the problem, with
the pointer on the link, do a right click and then select <STRONG>save link as</STRONG> to save the file with the correct file name.

<P>
CVS;

<P>
You can download latest version of perl-ldap from SourceForge by executing
a anonymous CVS ``get'' command. When the password is requested press the
enter key.

<P>
The 2 lines in the following example should be put together as one
continuous line. Example;

<P>
<PRE> cvs -d:pserver:anonymous@cvs.perl-ldap.sourceforge.net:/cvsroot/perl-ldap
</PRE>
<P>
Web page;

<P>
Most of the time there is a URL link on the perl-ldap home page on
sourceforge that points to the latest released version of perl-ldap. Due to
the fact that humans must update the web page to point to a new release it
sometimes does not get updated as quickly as it should.

<P>
<STRONG>WARNING:</STRONG>  The perl-ldap module is stored on CPAN as a *.gz file. Netscape on Windows
systems sometimes has a problem storing the module with the correct name,
it will replace the *.tar.gz with *_tar.tar. To correct the problem, with
the pointer on the link, do a right click and then select <STRONG>save link as</STRONG> to save the file with the correct file name.

<P>
<HR>
<H2><A NAME="What_is_CVS_">What is CVS.</A></H2>
<P>
``CVS'' is an acronym for the ``Concurrent Versions System''. CVS is a
``Source Control'' or ``Revision Control'' tool designed to keep track of
source changes made by groups of developers working on the same files,
allowing them to stay in sync with each other as each individual chooses.

<P>
<HR>
<H1><A NAME="LDAP_AND_DIRECTORY_TERMINOLOGY_">LDAP AND DIRECTORY TERMINOLOGY.</A></H1>
<P>
In order to help the user understand the perl-ldap module better some key
LDAP terminology is defined here.

<P>
<HR>
<H2><A NAME="What_is_a_directory_">What is a directory.</A></H2>
<P>
A directory is a special purpose database that usually contains typed
information such as text strings, binary data, or X.509 certificates.

<P>
<HR>
<H2><A NAME="What_is_LDAP_">What is LDAP.</A></H2>
<P>
LDAP stands for Lightweight Directory Access Protocol. The word <EM>Protocol</EM> is the key word in the definition given in the preceding sentence, LDAP is <EM>NOT</EM> hardware or software. It is a protocol that defines how a client and server
will communicate with one another.

<P>
The Lightweight Directory Access Protocol is defined in a series of
Requests For Comments, better known as <CODE>RFC(s).</CODE> The RFCs can be
found on the Internet. A very good source for all of the LDAP RFCs can be
found in the OpenLDAP, <A
HREF="http://www.OpenLDAP.org/">http://www.OpenLDAP.org/</A> , software
bundle that can be downloaded free of charge from the Internet. Some of the
more important RFC numbers are RFC 1777 for LDAPv2 and RFC 2251 for LDAPv3.

<P>
<HR>
<H2><A NAME="What_is_a_LDAP_Directory_">What is a LDAP Directory.</A></H2>
<P>
In the strictest terms of the definition there is no such thing as a LDAP
directory. To be practical about this situation every day directory
professionals refer to their directory as `` a LDAP directory'' because it
is easy to say and it does convey the type of protocol used to communicate
with their directory. Using this definition a LDAP directory is a directory
whose server software conforms to the Lightweight Directory Access Protocol
when communicating with a client.

<P>
<HR>
<H2><A NAME="What_is_an_Entry_">What is an Entry.</A></H2>
<P>
The traditional directory definition of a directory object is called an
Entry. Entries are composed of attributes that contain the information to
be recorded about an object.

<P>
Another non-traditional definition of a directory object is called a
record. Some directory professionals prefer to use this definition because
of the confusion that sometimes results when using the term Entry.

<P>
<HR>
<H2><A NAME="What_is_a_Distinguished_Name_">What is a Distinguished Name.</A></H2>
<P>
Every entry in a directory, whether it is X.500 or LDAP, has a
Distinguished Name, or DN. It is a unique Entry identifier through out the
complete directory. No two Entries can have the same DN within the same
directory.

<P>
Example of a DN:  

<P>
<PRE> cn=Road Runner, ou=bird, dc=carton, dc=com
 ou=bird, dc=carton, dc=com
 dc=carton, dc=com
 dc=com
</PRE>
<P>
<HR>
<H2><A NAME="What_is_a_Relative_Distinguished">What is a Relative Distinguished Name.</A></H2>
<P>
Every Entry in a directory, whether it is X.500 or LDAP, has a
Distinguished Name which is made up of a sequence of Relative Distinguished
Names, or RDNs. The sequences of RDNs are separated by commas (,) or
semi-colons (;). There can be more than one identical RDN in a directory,
but they must be in different bases, or branches, of the directory.

<P>
Example of a DN: 

<P>
<PRE> cn=Road Runner,ou=bird,dc=carton,dc=com
</PRE>
<P>
<PRE> RDNs of the proceeding DN: 
 RDN =&gt; cn=Road Runner
 RDN =&gt; ou=bird
 RDN =&gt; dc=carton
 RDN =&gt; dc=com
</PRE>
<P>
The RDNs are delimited by a comma.

<P>
<HR>
<H2><A NAME="What_is_a_Naming_RDN_">What is a Naming RDN.</A></H2>
<P>
Example of a DN:

<P>
<PRE> cn=Road Runner,ou=bird,dc=carton,dc=com  
</PRE>
<P>
<PRE> Naming RDN of the proceeding DN:
</PRE>
<P>
<PRE> cn=Road Runner     
</PRE>
<P>
Most of the time when directory professionals refer to the RDN of an entry,
this is the RDN that they are referring to.

<P>
<HR>
<H2><A NAME="What_is_a_search_base_">What is a search base.</A></H2>
<P>
A search base is a Distinguished Name that is the starting point of search
queries.

<P>
Example of a DN:

<P>
<PRE> cn=Road Runner,ou=bird,dc=carton,dc=com  
</PRE>
<P>
Possible search <CODE>base(s)</CODE> for the proceeding DN:

<P>
<PRE> Base =&gt; cn=Road Runner,ou=bird,dc=carton,dc=com  
 Base =&gt; ou=bird,dc=carton,dc=com  
 Base =&gt; dc=carton,dc=com  
 Base =&gt; dc=com  
</PRE>
<P>
Setting the search base to the lowest possible branch of the directory will
speed up searches considerably.

<P>
<HR>
<H2><A NAME="What_is_an_attribute_">What is an attribute.</A></H2>
<P>
The <CODE>entry(s)</CODE> in a directory are composed of attributes that
contain information about the object. Each attribute has a type and can
contain one or more values. The attribute type is associated with a syntax
that defines what kind of information can be stored in the attributes
values and controls how directory operations on the attribute behave. What
attributes are required and allowed in a entry is controlled by content
rules that are defined on a per-server basis or by a special attribute in
each entry called an objectClass.

<P>
<HR>
<H2><A NAME="What_is_the_difference_between_a">What is the difference between a LDAP server and a relational database</A></H2>
<P>
The most basic difference is that a directory server is a specialized
database designed to provide fast searches. While a relational database is
optimized for transactions (where a series of operations is counted as 1,
thus if one of the steps fails, the RDBMS can roll-back to the state it was
in before you started).

<P>
Directories also typically are hierarchical in nature (RDBMS is typically
flat, but you can implement a hierarchy using tables and queries),
network-able, distributed and replicated.

<P>
LDAP provides an open-standard to a directory service.

<P>
Typically we use LDAP for email directories (all popular email clients
provide an LDAP client now) and authorization services (authentication and
access control).

<P>
You could use a RDBMS for these types of queries but there's not a set
standard, in particular over TCP/IP to connect to databases over the
network. There's language specific protocols (like Perl's DBI and Java's
JDBC) that hide this problem behind an API abstraction, but that's not a
replacement for a standard access protocol.

<P>
LDAP is starting to be used on roles traditionally played by RDBMS in terms
of general data management because it's easier to setup a LDAP server (once
you understand the basic nomenclature) and you don't need a DBA to write
your queries and more importantly all LDAP servers speak the same essential
protocol, thus you don't have to fuss with a database driver trying to
connect it to the Internet. Once you have an LDAP server up and running,
it's automatically available over the 'net. It's possible to connect to a
LDAP server from a variety of mechanisms, including just about every
possible programming language.

<P>
More information on this topic can be found on the following URLs;

<P>
<PRE> <A HREF="http://www.openldap.org/faq/data/cache/378.html">http://www.openldap.org/faq/data/cache/378.html</A>
</PRE>
<P>
<PRE> <A HREF="http://www.messagingdirect.com/publications/IC-6055.html">http://www.messagingdirect.com/publications/IC-6055.html</A>
</PRE>
<P>
<HR>
<H2><A NAME="What_is_the_difference_between_a">What is the difference between a ldap reference and a ldap referral?</A></H2>
<P>
A referral is returned when the <STRONG>entire</STRONG> operation must be resent to another server.

<P>
A continuation reference is returned when <STRONG>part</STRONG> of the operation must be resent to another server.

<P>
See RFC 2251 section 4.5.3 for more details.

<P>
<HR>
<H1><A NAME="PERL_LDAP_INSTALLATION">PERL-LDAP INSTALLATION</A></H1>
<P>
<HR>
<H2><A NAME="How_do_I_install_perl_ldap_">How do I install perl-ldap ?</A></H2>
<P>
To install the modules that are in the perl-ldap distribution follow the
same steps that you would for most other distributions found on CPAN, that
is

<P>
<PRE>   # replace 0.13 with the version you have
</PRE>
<P>
<PRE>   gunzip perl-ldap-0.13.tar.gz
   tar xvf perl-ldap-0.13.tar       
   cd perl-ldap-0.13
   
   perl Makefile.PL
   make
   make test
   make install
</PRE>
<P>
<HR>
<H2><A NAME="But_I_do_not_have_make_how_can_">But I do not have make, how can I install perl-ldap ?</A></H2>
<P>
Well as luck would have it the modules in perl-ldap do not do anything
complex, so a simple copy is enough to install. First run

<P>
<PRE>  perl -V
</PRE>
<P>
This will output information about the version of perl you have installed.
Near the bottom you will find something like

<P>
<PRE>  @INC:
    /usr/local/perl/perl5.005/lib/5.00502/sun4-solaris
    /usr/local/perl/perl5.005/lib/5.00502
    /usr/local/perl/perl5.005/lib/site_perl/5.005/sun4-solaris
    /usr/local/perl/perl5.005/lib/site_perl/5.005
    .
</PRE>
<P>
This is a list of directories that perl searches when it is looking for a
module. The directory you need is the site_perl directory, but without the
system architecture name, in this case it is
<CODE>/usr/local/perl/perl5.005/lib/site_perl/5.005</CODE>. The files required can then be installed with

<P>
<PRE>   # replace 0.13 with the version you have
</PRE>
<P>
<PRE>   gunzip perl-ldap-0.13.tar.gz
   tar xvf perl-ldap-0.13.tar       
   cd perl-ldap-0.13/lib
</PRE>
<P>
<PRE>   cp * /usr/local/perl/perl5.005/lib/site_perl/5.005
</PRE>
<P>
<HR>
<H2><A NAME="What_other_modules_will_I_need_">What other modules will I need ?</A></H2>
<P>
perl-ldap does use other modules. Some are required, but some are optional
(ie required to use certain features)

<DL>
<DT><STRONG><A NAME="item_Convert">Convert::ASN1</A></STRONG><DD>
<P>
This module is required for perl-ldap to work.

<P>
You can obtain the latest release from <A
HREF="http://search.cpan.org/search?module=Convert::ASN1">http://search.cpan.org/search?module=Convert::ASN1</A>


<DT><STRONG><A NAME="item_Digest">Digest::MD5</A></STRONG><DD>
<P>
This module is optional. It also requires a C compiler when installing. You
only need to install Digest::MD5 if you want to use the SASL authentication
method.

<P>
You can obtain the latest release from <A
HREF="http://search.cpan.org/search?module=Digest::MD5">http://search.cpan.org/search?module=Digest::MD5</A>


<DT><STRONG><A NAME="item_URI">URI::ldap</A></STRONG><DD>
<P>
This module is optional. You only need to install URI::ldap if you are
going to need to parse ldap referrals. <A HREF="../../Net/LDAP.html">Net::LDAP</A> does not do this automatically yet, so this module is not used by
perl-ldap.

<P>
You can obtain the latest release from <A
HREF="http://search.cpan.org/search?module=URI::ldap">http://search.cpan.org/search?module=URI::ldap</A>


<DT><STRONG><A NAME="item_OpenSSL">OpenSSL and IO::Socket::SSL for Net::LDAPS</A></STRONG><DD>
<P>
If you want to use Net::LDAP::LDAPS you will need this module and the
OpenSSL software package.

<P>
You can obtain the latest release of IO::Socket::SSL from <A
HREF="http://search.cpan.org/search?module=IO::Socket::SSL">http://search.cpan.org/search?module=IO::Socket::SSL</A>


<P>
You can obtain the latest release of OpenSSL from <A
HREF="http://www.openssl.org/">http://www.openssl.org/</A>

<P>
If you are using a Linux system, many of the distributions have RPM
packages that you can install. Use your favorite web search engine to find
the package that you need.

<DT><STRONG><A NAME="item_XML">XML::Parser</A></STRONG><DD>
<P>
If you want to use Net::LDAP::DSML you will need this module.

<P>
You can obtain the latest release from <A
HREF="http://search.cpan.org/search?module=XML::Parser">http://search.cpan.org/search?module=XML::Parser</A>
 

</DL>
<P>
<HR>
<H1><A NAME="USING_NET_LDAP">USING NET::LDAP</A></H1>
<P>
<HR>
<H2><A NAME="How_do_I_connect_to_my_server_">How do I connect to my server ?</A></H2>
<P>
The connection to the server is created when you create a new Net::LDAP
object, e.g.

<P>
<PRE>  $ldap = Net::LDAP-&gt;new($server);
</PRE>
<P>
<HR>
<H2><A NAME="Net_LDAP_new_sometimes_returns">Net::LDAP-&gt;new sometimes returns undef, why ?</A></H2>
<P>
The constructor will return undef if there was a problem connecting to the
specified server. Any error message will be available in $@

<P>
<HR>
<H2><A NAME="How_can_I_tell_when_the_server_r">How can I tell when the server returns an error, bind() always returns
true ?</A></H2>
<P>
Most methods in Net::LDAP return a <A HREF="../../Net/LDAP/Message.html">Net::LDAP::Message</A> 
object, or a sub-class of that. This object will hold the results from the
server, including the result code.

<P>
So, for example, to determine the result of the bind operation.

<P>
<PRE>  $mesg = $ldap-&gt;bind( $dn, password =&gt; $passwd );
  
  if ( $mesg-&gt;code ) {
    # Handle error codes here
  }
</PRE>
<P>
<HR>
<H2><A NAME="How_can_I_set_the_ldap_version_o">How can I set the ldap version of a connection to my ldap server?</A></H2>
<P>
This is done by adding the version option when binding to the ldap server.

<P>
For example;

<P>
<PRE>  $mesg = $ldap-&gt;bind( $dn, password =&gt; $passwd, version =&gt; 3 );
</PRE>
<P>
Valid version numbers are 2 and 3.

<P>
<HR>
<H2><A NAME="I_did_a_search_on_my_directory_u">I did a search on my directory using the 'search' method. Where did
the results go ?</A></H2>
<P>
Your search results are stored in a 'search object' container. Consider the
following:

<P>
<PRE> use Net::LDAP;
</PRE>
<P>
<PRE> $ldap = Net::LDAP-&gt;new('ldap.acme.com') or die &quot;$@&quot;;
 $mesg = $ldap-&gt;search(
                       base   =&gt; &quot;o=acme.com&quot;,
                       filter =&gt; &quot;uid=jsmith&quot;,
                      );
</PRE>
<P>
<CODE>$mesg</CODE> is a search object container. It is a reference blessed
into the
<A HREF="../../Net/LDAP/Search.html">Net::LDAP::Search</A> package. By calling methods on this object you can obtain information about
the result and also the individual entries.

<P>
The first thing to check is if the search was successful. This is done with
with the method $mesg-&gt;code. This method will return the status code
that the server returned. A success will yield a zero value, but there are
other values, some of which could also be considered a success. See <A HREF="../../Net/LDAP/Constant.html">Net::LDAP::Constant</A>



<P>
<PRE>  use Net::LDAP::Util qw(ldap_error_text);
</PRE>
<P>
<PRE>  die ldap_error_text($mesg-&gt;code)
    if $mesg-&gt;code;
</PRE>
<P>
There are two ways in which you can access the entries. You can access then
with an index or you can treat the container like a stack and shift each
entry in turn. For example

<P>
<PRE>  # as an array
</PRE>
<P>
<PRE>  # How many entries were returned from the search
  my $max = $mesg-&gt;count; 
</PRE>
<P>
<PRE>  for( my $index = 0 ; $index &lt; $max ; $index++) {
    my $entry = $mesg-&gt;entry($index);
    # ...
  }
</PRE>
<P>
<PRE>  # or as a stack
  
  while( my $entry = $mesg-&gt;shift_entry) {
    # ...
  }
</PRE>
<P>
In each case <CODE>$entry</CODE> is an entry object container. It is a
reference blessed into the <A HREF="../../Net/LDAP/Entry.html">Net::LDAP::Entry</A> package. By calling methods on this object you can obtain information about
the entry.

<P>
For example, to obtain the DN for the entry

<P>
<PRE>  $dn = $entry-&gt;dn;
</PRE>
<P>
To obtain the attributes that a given entry has

<P>
<PRE>  @attrs = $entry-&gt;attributes;
</PRE>
<P>
And to get the list of values for a given attribute

<P>
<PRE>  @values = $entry-&gt;get( 'sn' );
</PRE>
<P>
And to get the first of the values for a given attribute

<P>
<PRE>  $values = $entry-&gt;get( 'cn' );
</PRE>
<P>
One thing to remember is that attribute names are case insensitive, so
'sn', 'Sn', 'sN' and 'SN' are all the same.

<P>
So, if you want to print all the values for the attribute <CODE>'ou'</CODE> then this is as simple as

<P>
<PRE>  foreach ($entry-&gt;get_value( 'ou' )) {
      print $_,&quot;\n&quot;;
    }
</PRE>
<P>
Now if you just want to print all the values for all the attributes you can
do

<P>
<PRE>  foreach my $attr ($entry-&gt;attributes) {
    foreach my $value ($entry-&gt;get_value($attr)) {
      print $attr, &quot;: &quot;, $value, &quot;\n&quot;;
    }
  }
</PRE>
<P>
<HR>
<H2><A NAME="How_do_I_limit_the_scope_of_a_di">How do I limit the scope of a directory search.</A></H2>
<P>
You limit the scope of a directory search by setting the scope parameter of
search request. Consider the following:

<P>
<PRE> use Net::LDAP;
</PRE>
<P>
<PRE> $ldap = Net::LDAP-&gt;new('ldap.acme.com') or die &quot;$@&quot;;
 $mesg = $ldap-&gt;search(
                       base   =&gt; &quot;o=acme.com&quot;,
                       scope  =&gt; 'sub',
                       filter =&gt; &quot;uid=jsmith&quot;,
                      );
</PRE>
<P>
Values for the scope parameter are as follows.

<P>
<PRE> base  Search only the base object.
 
 one   Search the entries immediately below the base
       object.
 
 sub   Search the whole tree below the base object.
       This is the default.                                         
</PRE>
<P>
<HR>
<H1><A NAME="GETTING_SEARCH_RESULTS">GETTING SEARCH RESULTS</A></H1>
<P>
There are two ways of retrieving the results of a requested LDAP search;
inline and by using a callback subroutine.

<P>
<HR>
<H2><A NAME="USING_THE_INLINE_APPROACH">USING THE INLINE APPROACH</A></H2>
<P>
Using the inline approach involves requesting the data and then waiting for
all of the data to be returned before the user starts processing the data.

<P>
Example: 

<P>
<PRE> use Net::LDAP;
</PRE>
<P>
<PRE> $ldap = Net::LDAP-&gt;new('ldap.acme.com') or die &quot;$@&quot;;
 $mesg = $ldap-&gt;search(
                       base   =&gt; &quot;o=acme.com&quot;,
                       scope  =&gt; 'sub',
                       filter =&gt; &quot;sn=smith&quot;,
                      );
  #
  # At this point the user can get the returned data as an array
  # or as a stack.
  # In this example we will use an array
</PRE>
<P>
<PRE>  # How many entries were returned from the search
  my $max = $mesg-&gt;count; 
</PRE>
<P>
<PRE>  for( my $index = 0 ; $index &lt; $max ; $index++) 
  {
    my $entry = $mesg-&gt;entry($index);
    my $dn = $entry-&gt;dn; # Obtain DN of this entry
</PRE>
<P>
<PRE>    @attrs = $entry-&gt;attributes; # Obtain attributes for this entry.
    foreach my $var (@attrs)
    {
     #get a list of values for a given attribute
     $attr = $entry-&gt;get_value( $var, asref =&gt; 1 );
     if ( defined($attr) )         
     {          
         foreach my $value ( @$attr )          
         {           
          print &quot;$var: $value\n&quot;;  # Print each value for the attribute.
         }         
     }                                                                       
    }
  }
</PRE>
<P>
As you can see the example is straight forward, but there is one drawback
to this approach. You must wait until all entries for the request search to
be returned before you can process the data. If there several thousand
entries that match the search filter this could take quite a long time
period.

<P>
<HR>
<H2><A NAME="USING_THE_CALLBACK_SUBROUTINE_AP">USING THE CALLBACK SUBROUTINE APPROACH</A></H2>
<P>
Using the callback approach involves requesting the data be sent to a
callback subroutine as each entry arrives at the client.

<P>
A callback is just a subroutine that is passed two parameters when it is
called, the mesg and entry objects.

<P>
Example: 

<P>
<PRE> use Net::LDAP;
</PRE>
<P>
<PRE> $ldap = Net::LDAP-&gt;new('ldap.acme.com') or die &quot;$@&quot;;
 $mesg = $ldap-&gt;search(
                       base   =&gt; &quot;o=acme.com&quot;,
                       scope  =&gt; 'sub',
                       filter =&gt; &quot;sn=smith&quot;,
                       callback =&gt; \&amp;callback,
                      );
 #
 # At this point the user needs to check the status of the
 # ldap search.
 # 
</PRE>
<P>
<PRE> if ( $mesg-&gt;code )
 {
    $errstr = $mesg-&gt;code;
    print &quot;Error code:  $errstr\n&quot;;
    $errstr = ldap_error_text($errstr);
    print &quot;$errstr\n&quot;;
 } 
</PRE>
<P>
<PRE> sub callback
 {
 my ( $mesg, $entry) = @_;
</PRE>
<P>
<PRE>   #
   # First you must check to see if something was returned.
   # Last execution of callback subroutine will have no
   # defined entry and mesg object
   #
   if ( !defined($entry) )
   {
     print &quot;No records found matching filter $match.\n&quot;
     if ($mesg-&gt;count == 0) ; # if mesg is not defined nothing will print.
     return;
   }
</PRE>
<P>
<PRE>   my $dn = $entry-&gt;dn; # Obtain DN of this entry
 
   @attrs = $entry-&gt;attributes; # Obtain attributes for this entry.
   foreach my $var (@attrs)
   {
    #get a list of values for a given attribute
    $attr = $entry-&gt;get_value( $var, asref =&gt; 1 );
    if ( defined($attr) )         
    {          
      foreach my $value ( @$attr )          
      {           
        print &quot;$var: $value\n&quot;;  # Print each value for the attribute.
      }         
    }                                                                       
   }
   #
   # For large search requests the following 2 lines of code
   # may be very important, they will reduce the amount of memory 
   # used by the search results.
   #
   # If the user is not worried about memory useage then the 2 lines
   # of code can be omitted.
   #
   $mesg-&gt;pop_entry;
 
 }  # End of callback subroutine
</PRE>
<P>
As you can see the example is straight forward and it does not waste time
waiting for all of the entries to be returned. However if the pop_entry
method is not used the callback approach can allocate a lot of memory to
the search request.

<P>
<HR>
<H1><A NAME="USING_NET_LDAPS">USING NET::LDAPS</A></H1>
<P>
<HR>
<H2><A NAME="Using_a_potentially_encrypted_S">Using a potentially encrypted (SSL) network connection, how do I connect to my server?</A></H2>
<P>
This class is a subclass of Net::LDAP so all the normal Net::LDAP methods
can be used with a Net::LDAPS object; see the documentation for Net::LDAP
to find out how to query a directory server using the LDAP protocol.                        

<P>
The connection to the server is created when you create a new Net::LDAPS
object, e.g.

<P>
<PRE>  $ldaps = Net::LDAPS-&gt;new($server,
                           port =&gt; '10000',
                           verify =&gt; 'require',
                           capath =&gt; '/usr/local/cacerts/',
                           );
</PRE>
<P>
There are additional options to the LDAPS new method and several additional
methods are included in the LDAPS object class.  

<P>
For further information and code examples read the LDAPS module
documentation; perldoc Net::LDAPS

<P>
<HR>
<H1><A NAME="USING_LDAP_GROUPS_">USING LDAP GROUPS.</A></H1>
<P>
<HR>
<H2><A NAME="What_are_LDAP_groups_">What are LDAP groups.</A></H2>
<P>
LDAP groups are a collection of distinguished names (DN) that are listed in
an attribute called member. One <EM>important note</EM> to remember is that a group can be a collection of groups. This does <EM>NOT</EM> imply that the subgroups will be flattened into one big group.

<P>
Two scripts for working with groups are available in the contrib directory.
They are isMember.pl and printMembers.pl. 

<P>
<HR>
<H2><A NAME="How_do_you_format_a_filter_to_se">How do you format a filter to search for entries whose 'member'
attribute has a particular value?</A></H2>
<P>
Asking for (member=*) is OK - the directory uses the equality matching rule
which is defined for the member attribute.

<P>
Asking for (member=c*) is not OK - there is no defined substring matching
rule for the member attribute. That's because the member values are *not*
strings, but distinguished names. There is no substring matching rule for
DNs, see RFC 2256 section 5.50.

<P>
What you have to do is get the results of (member=*) and then select the
required results from the returned values. You need to do this using
knowledge of the string representation of DNs defined in RFC 2253, which is
important because the same DN can have different string representations. So
you need to perform some canonicalization if you want to be correct.

<P>
<HR>
<H1><A NAME="USING_DSML_">USING DSML.</A></H1>
<P>
<HR>
<H2><A NAME="How_can_I_access_DSML_features_f">How can I access DSML features from PERL-LDAP.</A></H2>
<P>
Directory Service Markup Language (DSML) is the XML standard for
representing directory service information in XML. Support for DSML is
include in PERL-LDAP starting with version .20.

<P>
At the moment this module only reads and writes DSML entry entities. It
cannot process any schema entities because schema entities are processed
differently than elements. Eventually this module will be a full level 2
consumer and producer enabling you to give you full DSML conformance. The
specification for DSML is at <A
HREF="http://www.dsml.org">http://www.dsml.org</A>

<P>
For further information and code examples read the DSML module
documentation; perldoc Net::LDAP::DSML

<P>
<HR>
<H1><A NAME="USING_CONTROLS_AND_VIRTUAL_LISTS">USING CONTROLS AND VIRTUAL LISTS.</A></H1>
<P>
<HR>
<H2><A NAME="How_do_I_access_the_Control_feat">How do I access the Control features.</A></H2>
<P>
Support for LDAP version 3 Control objects is included in perl-ldap
starting with version .20.

<P>
For further information and code examples read the Control module
documentation; perldoc Net::LDAP::Control

<P>
<HR>
<H2><A NAME="How_do_I_access_the_Virtual_List">How do I access the Virtual List features.</A></H2>
<P>
Support for Virtual Lists is included in perl-ldap starting with version
.20.

<P>
For further information and code examples read the Control module
documentation; perldoc Net::LDAP::Control

<P>
<HR>
<H1><A NAME="GENERAL_QUESTIONS_">GENERAL QUESTIONS.</A></H1>
<P>
<HR>
<H2><A NAME="Are_there_any_other_code_example">Are there any other code examples.</A></H2>
<P>
Yes, there is an Examples pod file. To view the pod do the following
command; perldoc Net::LDAP::Examples

<P>
There is user contributed software in the contrib directory that is
supplied with the PERL-LDAP distribution. This is an excellent source of
information on how to use the PERL-LDAP module.

<P>
<HR>
<H2><A NAME="Can_I_contribute_perl_scripts_th">Can I contribute perl scripts that use perl-ldap
to the contrib section?</A></H2>
<P>
Any one can submit a perl script that uses perl-ldap for inclusion in the
contrib section. Graham Barr will determine if the script will be included
and will do the initial check in of the script to the CVS system on
sourceforge. Graham will make you the owner/developer of the script. 

<P>
There are a couple of requirements for consideration.

<P>
You must supply a one line description of your script to be included in the
contrib readme file.

<P>
Inside the script will be the pod documentation for the script. No
auxiliary documentation will be allowed. For examples of how to do this see
the tklkup or schema scripts currently in the contrib section.

<P>
If Graham decides to include your script in the contrib section, you must
register with sourceforge before your scripts will be put into the contrib
CVS system.

<P>
<HR>
<H2><A NAME="Is_possible_to_get_a_complete_en">Is possible to get a complete entry, dn and attributes 
without specifying the attributes name?</A></H2>
<P>
Yes, just specify you want a list of no attributes back. The RFC says that
this tells the server to return all readable attributes back (there may be
access controls to prevent some from being returned.)

<P>
So in the search method, just set (for LDAPv2):

<P>
<PRE>                attrs =&gt; [ ]
</PRE>
<P>
If you are using LDAPv3, you can specify an attribute called ``*'' instead,
which lets you ask for additional (eg operational) attributes in the same
search.

<P>
<PRE>                attrs =&gt; [ &quot;*&quot; ]
</PRE>
<P>
<HR>
<H2><A NAME="How_do_I_put_a_jpeg_photo_into_a">How do I put a jpeg photo into a entry in the directory.</A></H2>
<P>
Follow the following code example, replacing the (...) with whatever is
relevant to your setup. 

<P>
<PRE>  use Net::LDAP;
  use Net::LDAP::Util qw(ldap_error_text);
  use CGI;
  
  local $/ = undef;
  my $jpeg = &lt;$filename&gt;;
</PRE>
<P>
<PRE>  my $ldap = new Net::LDAP(...);
  my $res = $ldap-&gt;bind(...);
     $res = $ldap-&gt;modify(...,
                   add =&gt; [ 'jpegPhoto' =&gt; [ $jpeg ] ]);
     $res = $ldap-&gt;unbind();
</PRE>
<P>
<HR>
<H2><A NAME="How_do_I_add_a_jpeg_photo_into_a">How do I add a jpeg photo into a entry in the directory via html-forms.</A></H2>
<P>
Follow the following code example, replacing the (...) with whatever is
relevant to your setup. 

<P>
<PRE>  use Net::LDAP;
  use Net::LDAP::Util qw(ldap_error_text);
  use CGI;
</PRE>
<P>
<PRE>  my $q = new CGI;
</PRE>
<P>
<PRE>  print $q-&gt;header;
  print $q-&gt;start_html(-title =&gt; 'Change JPEG photo');
</PRE>
<P>
<PRE>  if ($q-&gt;param('Update')) {
          my $filename = $q-&gt;param('jpeg');
          local $/ = undef;
          my $jpeg = &lt;$filename&gt;;
</PRE>
<P>
<PRE>          my $ldap = new Net::LDAP(...);
          my $res = $ldap-&gt;bind(...);
          $res = $ldap-&gt;modify(...,
                          add =&gt; [ 'jpegPhoto' =&gt; [ $jpeg ] ]);
          $res = $ldap-&gt;unbind();
  } else {
          print $q-&gt;start_multipart_form();
          print $q-&gt;filefield(-name =&gt; 'jpeg', -size =&gt; 50);
          print $q-&gt;submit('Update');
          print $q-&gt;end_form();
  }
</PRE>
<P>
<PRE>  print $q-&gt;end_html();
</PRE>
<P>
<HR>
<H2><A NAME="What_happens_when_you_delete_an_">What happens when you delete an attribute that does not exist.</A></H2>
<P>
It is an error to delete an attribute that doesn't exist. When you get the
error back the server ignores the entire modify operation you sent it, so
you need to make sure the error doesn't happen.

<P>
Another approach, if you are using LDAPv3 (note Net::LDAP does not use
LDAPv3 by default) is to use a 'replace' with your attribute name and no
values. In LDAPv3, this is defined to always work even if that attribute
doesn't exist in the entry.

<P>
ie:

<P>
<PRE>  my $mesg = $ldap-&gt;modify( $entry, replace =&gt; { %qv_del_arry } );
</PRE>
<P>
But make sure you are using LDAPv3, because that is defined to *not* work
in LDAPv2. (A nice incompatibility between LDAPv2 and LDAPv3.)

<P>
<HR>
<H2><A NAME="How_can_I_delete_a_referral_from">How can I delete a referral from an LDAP tree.</A></H2>
<P>
Since this is a proprietary feature, you will have to check your server's
documentation. You might find that you need to use a control. If there is a
control called something like managedsait, that's the one you should
probably use. For proper operation you will need the oid number for
managedsait; 2.16.840.1.113730.3.4.2 and do not specify a value for type.

<P>
The code required will look similar to the following code snippet.

<P>
<PRE>  $mesg =  $ldap-&gt;delete(&quot;ref=\&quot;ldap://acme/c=us,o=bricks\&quot;,o=clay&quot;,
                  control =&gt; {type =&gt; &quot;2.16.840.1.113730.3.4.2&quot;} ); 
</PRE>
<P>
<HR>
<H2><A NAME="How_do_I_add_an_ACI_ACL_entry_to">How do I add an ACI/ACL entry to a directory server with
Perl-LDAP.</A></H2>
<P>
The following code snippet works with a Netscape directory server and
should work with any other LDAP directory server. You will need the specify
the correct DN (-DN-) and correct <CODE>attribute(s)</CODE> (-nom attr-).

<P>
<PRE>  my $aci = '(target=&quot;ldap:///-DN-&quot;)(targetattr=&quot;-nom attr-&quot;)(version 3.0;
              acl &quot;-nom acl-&quot;; deny(all) userdn = &quot;ldap:///self&quot;;)' ;
</PRE>
<P>
<PRE>  $ldap-&gt;modify($dn_modif, add =&gt; {'aci' =&gt; $aci });
</PRE>
<P>
<HR>
<H2><A NAME="How_do_I_avoid_file_type_and_dat">How do I avoid file type and data type miss-matching when loading
data from a Win32 system.</A></H2>
<P>
When loading a binary attribute with data read from a file on a Win32
system, it has been noted that you should set ``binmode'' on the file
before reading the file contents into the data array.

<P>
Another possible solution to this problem is to convert the binary data
into a base64 encoded string and then store the encoded string in the file.
Then when reading the file, decode the base64 encoded string back to binary
and then use perl ldap to store the data in the directory.

<P>
<HR>
<H2><A NAME="How_do_I_create_a_Microsoft_Exch">How do I create a Microsoft Exchange user.</A></H2>
<P>
This is a solution provide by a perl-ldap user.

<P>
This code works with ActiveState Perl running on WinNT 4. Please note that
this requires the Win32::Perms module, and needs valid NT account info to
replace the placeholders. 

<P>
<PRE>  use Net::LDAP qw(:all);
  use Net::LDAP::Util;
  use Win32::Perms;
</PRE>
<P>
<PRE>  #Constants taken from ADSI Type Library
  $ADS_RIGHT_EXCH_ADD_CHILD = 1;
  $ADS_RIGHT_EXCH_DELETE = 0x10000;
  $ADS_RIGHT_EXCH_DS_REPLICATION = 64;
  $ADS_RIGHT_EXCH_DS_SEARCH = 256;
  $ADS_RIGHT_EXCH_MAIL_ADMIN_AS = 32;
  $ADS_RIGHT_EXCH_MAIL_RECEIVE_AS = 16;
  $ADS_RIGHT_EXCH_MAIL_SEND_AS = 8;
  $ADS_RIGHT_EXCH_MODIFY_ADMIN_ATT = 4;
  $ADS_RIGHT_EXCH_MODIFY_SEC_ATT = 128;
  $ADS_RIGHT_EXCH_MODIFY_USER_ATT = 2;
</PRE>
<P>
<PRE>  $EXCH_USER_RIGHTS = $ADS_RIGHT_EXCH_MAIL_RECEIVE_AS |
  $ADS_RIGHT_EXCH_MAIL_SEND_AS |
  $ADS_RIGHT_EXCH_MODIFY_USER_ATT;
</PRE>
<P>
<PRE>  $exch = new Net::LDAP('server', debug =&gt;0) || die $@;
</PRE>
<P>
<PRE>  $exch-&gt;bind( 'cn=admin_user,cn=nt_domain,cn=admin', version =&gt;3,
  password=&gt;'password');
</PRE>
<P>
<PRE>  $myObj = Win32::Perms-&gt;new();
  $Result = $myObj-&gt;Owner('nt_domain\user_name');
  $myObj-&gt;Group('nt_domain\Everyone');
  $myObj-&gt;Allow('nt_domain\user_name',
  $EXCH_USER_RIGHTS,OBJECT_INHERIT_ACE);
  $BinarySD = $myObj-&gt;GetSD(SD_RELATIVE);
  $TextSD = uc(unpack( &quot;H*&quot;, $BinarySD ));
  Win32::Perms::ResolveSid('nt_domain\user_name', $sid);
  $mysid = uc(unpack(&quot;H*&quot;,$sid));
</PRE>
<P>
<PRE>  $result = $exch-&gt;add ( dn   =&gt;
                'cn=user_name,cn=container,ou=site,o=organisation',
                attr =&gt; [ 'objectClass' =&gt; ['organizationalPerson'],
                          'cn'   =&gt; 'directory_name',
                          'uid' =&gt; 'mail_nickname',
                          'mail' =&gt; 'smtp_address',
                        'assoc-nt-account' =&gt; [ $mysid ],
                        'nt-security-descriptor' =&gt; [ $TextSD ],
                        'mailPreferenceOption'  =&gt; 0
                        ]
              );
</PRE>
<P>
<PRE>  print ldap_error_name($result-&gt;code);
</PRE>
<P>
<HR>
<H1><A NAME="Using_X_509_certificates_">Using X.509 certificates.</A></H1>
<P>
<HR>
<H2><A NAME="How_do_I_store_X_509_certificate">How do I store X.509 certificates in the directory?</A></H2>
<P>
The first problem here is that there are many different formats to hold
certificates in, for example PEM, DER, PKCS#7 and PKCS#12. The directory
*only* uses the DER format (more correctly, it only uses the BER format)
which is a binary format.

<P>
Your first job is to ensure that your certificates are therefore in DER/BER
format. You could use OpenSSL to convert from PEM like this:

<P>
<PRE>        openssl x509 -inform PEM -in cert.pem -outform DER -out cert.der
</PRE>
<P>
Consult the OpenSSL documentation to find out how to perform other
conversions.

<P>
To add a certificate to the directory, just slurp in the DER/BER
certificate into a scalar variable, and add it to the entry's
userCertificate attribute. How you do that will depend on which version of
LDAP you are using.

<P>
To slurp in the certificate try something like this:

<P>
<PRE>        my $cert;
        {
                local $/ = undef; # Slurp mode
                open CERT, &quot;cert.der&quot; or die;
                $cert = &lt;CERT&gt;;
                close CERT;
        }
        # The certificate is now in $cert
</PRE>
<P>
For LDAPv2, because most directory vendors ignore the string representation
of certificates defined in RFC 1778, you should add this value to the
directory like this:

<P>
<PRE>        $res = $ldap-&gt;modify(&quot;cn=My User, o=My Company,c=XY&quot;,
                        add =&gt; [
                                'userCertificate' =&gt; [ $cert ]
                        ]);
        die &quot;Modify failed (&quot; . ldap_error_name($res-&gt;code) . &quot;)\n&quot;
                if $res-&gt;code;
</PRE>
<P>
For LDAPv3, you must do this instead:

<P>
<PRE>        $res = $ldap-&gt;modify(&quot;cn=My User, o=My Company, c=XY&quot;,
                        add =&gt; [
                                'userCertificate;binary' =&gt; [ $cert ]
                        ]);
        die &quot;Modify failed (&quot; . ldap_error_name($res-&gt;code) . &quot;)\n&quot;
                if $res-&gt;code;
</PRE>
<P>
Of course, the entry you are trying to add the certificate to must use
object classes that permit the userCertificate attribute, otherwise the
modify will fail with an object class violation error. The inetOrgPerson
structural object class permits userCertificates, as does the
strongAuthenticationUser auxiliary object class. Others might also.

<P>
<HR>
<H1><A NAME="ADDITIONAL_DIRECTORY_AND_LDAP_RE">ADDITIONAL DIRECTORY AND LDAP RESOURCES.</A></H1>
<P>
<HR>
<H2><A NAME="URL_s_">URL(s).</A></H2>
<P>
Directory Services Mark Language (DSML) <A
HREF="http://www.dsml.org/">http://www.dsml.org/</A>

<P>
eMailman LDAP information <A
HREF="http://www.emailman.com/ldap/">http://www.emailman.com/ldap/</A>

<P>
LDAPS, also known as LDAPGURU.
<EM>This web site has a nasty habit of resizing the browser
to cover the WHOLE screen.</EM>
<A HREF="http://www.ldaps.com">http://www.ldaps.com</A>

<P>
Jeff Hodges's Kings Mountain LDAP <A
HREF="http://www.kingsmountain.com/ldapRoadmap.shtml">http://www.kingsmountain.com/ldapRoadmap.shtml</A>


<P>
Mark Wahl's LDAP World at Innosoft. <A
HREF="http://www.innosoft.com/ldapworld/">http://www.innosoft.com/ldapworld/</A>


<P>
Open Source LDAP Directory Server. <A
HREF="http://www.openldap.org/">http://www.openldap.org/</A>

<P>
CriticalPath <A HREF="http://www.cp.net/">http://www.cp.net/</A>

<P>
Innosoft <A HREF="http://www.innosoft.com">http://www.innosoft.com</A>

<P>
IPlanet - Netscape and SUN Alliance <A
HREF="http://www.iplanet.com/">http://www.iplanet.com/</A>

<P>
MessagingDirect <A
HREF="http://www.messagingdirect.com/">http://www.messagingdirect.com/</A>

<P>
Netscape Directory Developers Area <A
HREF="http://developer.netscape.com/directory/">http://developer.netscape.com/directory/</A>


<P>
Nexor's X.500 and Internet Directories <A
HREF="http://www.nexor.com/info/directory.htm/">http://www.nexor.com/info/directory.htm/</A>


<P>
Novell's LDAPzone <A HREF="http://ldapzone.com/">http://ldapzone.com/</A>

<P>
SUN JAVA JNDI (Java Naming and Directory Interface) <A
HREF="http://www.java.sun.com/jndi/">http://www.java.sun.com/jndi/</A>

<P>
The 2 following URLs deal mainly with Microsoft's Active Directory.

<P>
Directory Works <A
HREF="http://directoryworks.com/">http://directoryworks.com/</A>

<P>
ActiveX LDAP Client <A
HREF="http://www.polonia-online.com/ldap/">http://www.polonia-online.com/ldap/</A>


<P>
<HR>
<H2><A NAME="BOOK_s_">BOOK(s)</A></H2>
<P>
Developing LDAP and ADSI Clients for <CODE>Microsoft(R)</CODE> Exchange. By
Sven B. Schreiber. ISBN: 0201657775

<P>
Implementing LDAP. By Mark Wilcox. ISBN: 1861002211

<P>
LDAP : Programming Directory-Enabled Applications With Lightweight
Directory Access Protocol. By Tim Howes, Mark Smith. ISBN: 1578700000

<P>
LDAP Programming with Java. By Rob Weltman, Tony Dahbura. ISBN: 0201657589

<P>
Solaris and LDAP Naming Services. By Tom Bialaski, Michael Haines. ISBN:
0-13-030678-9

<P>
Understanding and Deploying Ldap Directory Services. By Tim Howes, Mark
Smith, Gordon Good, Timothy A. Howe ISBN: 1578700701

<P>
<HR>
<H1><A NAME="AUTHOR_s_">AUTHOR(s)</A></H1>
<P>
Any good FAQ is made up of many authors, everyone that contributes
information to the perl-ldap mail list is a potential author.

<P>
An attempt to maintain this FAQ is being done by Clif Harden &lt;<A
HREF="mailto:charden@pobox.com">charden@pobox.com</A>&gt;

<P>
The original author of this FAQ was Graham Barr &lt;<A
HREF="mailto:gbarr@pobox.com">gbarr@pobox.com</A>&gt;

<P>
Please report any bugs, or post any suggestions, to the perl-ldap mailing
list &lt;<A
HREF="mailto:perl-ldap-dev@lists.sourceforge.net">perl-ldap-dev@lists.sourceforge.net</A>&gt;


<P>
<HR>
<H1><A NAME="COPYRIGHT">COPYRIGHT</A></H1>
<P>
Copyright (c) 1999-2000 Graham Barr. All rights reserved. This document is
distributed, and may be redistributed, under the same terms as Perl itself.

<hr>

</BODY>

</HTML>
